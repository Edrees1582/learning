<table
  mat-table
  [dataSource]="dataSource"
  matSort
  class="mat-elevation-z8"
  (matSortChange)="sortData($event)"
>
  <!-- Radio button column -->

  <ng-container matColumnDef="radio">
    <th mat-header-cell *matHeaderCellDef></th>
    <td
      mat-cell
      *matCellDef="let row"
      [ngClass]="{ selectedLeftSurvey: isSelected(row.SRV_ID) }"
    >
      <mat-radio-button
        [checked]="isSelected(row.SRV_ID)"
        (click)="selectSurvey(row)"
      ></mat-radio-button>
    </td>
  </ng-container>

  <!-- SurveyName Column -->
  <ng-container matColumnDef="surveyName">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Survey Name</th>
    <td
      mat-cell
      *matCellDef="let row"
      [ngClass]="{ selectedSurvey: isSelected(row.SRV_ID) }"
    >
      {{ row.SurveyName }}
    </td>
  </ng-container>

  <!-- From Column -->
  <ng-container matColumnDef="from">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>From</th>
    <td
      mat-cell
      *matCellDef="let row"
      [ngClass]="{ selectedSurvey: isSelected(row.SRV_ID) }"
    >
      {{ getStartDateString(row.SurveyPeriods) }}
    </td>
  </ng-container>

  <!-- To Column -->
  <ng-container matColumnDef="to">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>To</th>
    <td
      mat-cell
      *matCellDef="let row"
      [ngClass]="{ selectedSurvey: isSelected(row.SRV_ID) }"
    >
      {{ getEndDateString(row.SurveyPeriods) }}
    </td>
  </ng-container>

  <!-- Period Column -->
  <ng-container matColumnDef="period">
    <th mat-header-cell *matHeaderCellDef>Period</th>
    <td
      mat-cell
      *matCellDef="let row"
      [ngClass]="{ selectedRightSurvey: isSelected(row.SRV_ID) }"
    >
      <mat-form-field
        *ngIf="row.SurveyPeriods && checkIfNotOneDate(row.SurveyPeriods)"
      >
        <mat-label>Select Period</mat-label>
        <mat-select>
          @for (period of row.SurveyPeriods; track period) {
          <mat-option [value]="period"
            >{{ getStartDateString(row.SurveyPeriods).replaceAll("-", "/") }}
            -
            {{
              getEndDateString(row.SurveyPeriods).replaceAll("-", "/")
            }}</mat-option
          >
          }
        </mat-select>
      </mat-form-field>
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
  <tr
    mat-row
    *matRowDef="let row; columns: displayedColumns"
    [ngClass]="{ selectedSurvey: isSelected(row.SRV_ID) }"
  ></tr>
</table>
